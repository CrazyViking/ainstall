#!/bin/bash

#locale setup
echo "Select locale:"
echo "Press enter to continue:"
nano /etc/locale.gen
locale-gen
echo LANG=en_US.UTF-8 > /etc/locale.conf
export LANG=en_US.UTF-8

ls -s /usr/share/zoneinfo/America/New_York > /etc/localtime
hwclock --systohc --utc

clear

echo "Configure repositories (multilib support):"
echo "Press enter to continue:"
read -p
nano /etc/pacman.conf

clear

echo What should the hostname be?
read hostName
echo "$hostName" >> /etc/hostname

clear

echo "Create password for root:"
passwd

clear

echo "What should the user name be?:"
read userName
useradd -m -g users -G wheel,storage,power -s /bin/bash $userName

clear

echo "Create password for $userName:"
passwd $userName
#Allow all users to use sudo
echo "ALL ALL=(ALL) ALL" >> /etc/sudoers

#bootloader-gen
pacman -Syu --noconfirm grub os-prober
os-prober
mkinitcpio -p linux
grub-install --target=i386-pc --recheck /dev/sda
grub-mkconfig -o /boot/grub/grub.cfg

clear

#aur helper
echo "Installing trizen:"
echo "EDITOR="/usr/bin/nano"" >> /etc/environment

cd /home/$userName
curl -O https://aur.archlinux.org/cgit/aur.git/snapshot/trizen.tar.gz
tar -xvzf trizen.tar.gz
cd /home/$userName/trizen

chown -hR $userName /home/$userName

sudo -u $userName makepkg -csri --skippgpcheck

clear

#intel ucode
echo "Install if using Intel processor:"
pacman -Sy intel-ucode

clear

echo "Which desktop environment do you want? (plasma, gnome3, or xfce only)"
read deWM
case $deWM in
      plasma)
           pacman -S --noconfirm plasma-meta plasma-nm spectacle konsole gwenview dolphin partitionmanager kate ark qbittorrent
           systemctl enable sddm.service
           ;;
      gnome3)
           pacman -S --noconfirm gnome gparted gedit file-roller deluge
           systemctl enable gdm.service
           ;;
      xfce)
           pacman -S --noconfirm xfce4 xfce4-goodies gparted deluge sddm
           systemctl enable sddm.service
easc

echo "Install Nvidia GPU drivers with package nvidia (400+), nvidia-340xx (8000-300), or nvidia-304xx (6000-7000)"
echo "Press enter to continue:"
read -p
pacman -S --noconfirm bash-completion wpa_supplicant xorg-xinit xf86-video-vesa xorg-apps xorg firefox pulseaudio p7zip htop wine-staging winetricks libreoffice-fresh mpv adwaita-icon-theme links

systemctl enable NetworkManager.service
systemctl enable wpa_supplicant.service

rm -rf /ainstall /aconfig /home/$userName/trizen*

clear

echo "Install GPU drivers with package nvidia (400+), nvidia-340xx (8000-300), or nvidia-304xx (6000-7000)"
echo "You'll also probably want nvidia-settings and lib32-nvidia-utils"
